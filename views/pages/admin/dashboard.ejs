<!DOCTYPE html>
<html lang="id">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Admin Dashboard - E-Invoice Restu Production</title>
		<link rel="stylesheet" href="/css/admin-style.css" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
			integrity="sha512-iecdLmaskl7CVJkEzyD6lkDNlzVUbarSmtgQXxDcNqWoMg0do32T5D7mKontZWMNDL25AVyIu7G6CxSucVIurGQ=="
			crossorigin="anonymous"
			referrerpolicy="no-referrer"
		/>
	</head>
	<body>
		<div class="admin-container">
			<!-- Sidebar Overlay -->
			<div class="sidebar-overlay" id="sidebarOverlay"></div>

			<!-- Sidebar -->
			<aside class="sidebar" id="sidebar">
				<div class="sidebar-header">
					<h2>E-Invoice</h2>
					<p>Restu Production</p>
				</div>

				<nav class="sidebar-nav">
					<a href="/admin/invoice/dashboard" class="nav-item active">
						<span class="icon"><i class="bi bi-clipboard2-fill"></i></span>
						<span class="label">Dashboard</span>
					</a>
					<a href="/admin/invoice/create" class="nav-item">
						<span class="icon"><i class="fa-solid fa-plus"></i></span>
						<span class="label">Buat Invoice</span>
					</a>
					<a href="/admin/invoice/history" class="nav-item">
						<span class="icon"><i class="fa-solid fa-file-invoice"></i></span>
						<span class="label">Riwayat Invoice</span>
					</a>
				</nav>

				<div class="sidebar-footer">
					<a href="/auth/logout" class="logout-btn">
						<span class="icon">üö™</span>
						<span class="label">Logout</span>
					</a>
				</div>
			</aside>

			<!-- Main Content -->
			<main class="main-content">
				<div class="top-bar">
					<div class="top-bar-left">
						<button class="hamburger-menu" id="hamburgerMenu">‚ò∞</button>
						<h1>Dashboard</h1>
					</div>
					<div class="user-info">
						<span>Admin User</span>
						<div class="avatar">A</div>
					</div>
				</div>

				<div class="dashboard-content">
					<!-- Stats Grid -->
					<div class="stats-grid">
						<div class="stat-card">
							<div
								class="stat-icon"
								style="background: #e3f2fd; color: #1976d2"
							>
								üìÑ
							</div>
							<div class="stat-info">
								<p class="stat-label">Total Invoice</p>
								<p class="stat-value"><%= stats.total_invoices || 0 %></p>
							</div>
						</div>

						<div class="stat-card">
							<div
								class="stat-icon"
								style="background: #e8f5e9; color: #388e3c"
							>
								‚úì
							</div>
							<div class="stat-info">
								<p class="stat-label">Sudah Dibayar</p>
								<p class="stat-value"><%= stats.paid || 0 %></p>
							</div>
						</div>

						<div class="stat-card">
							<div
								class="stat-icon"
								style="background: #fff3e0; color: #f57c00"
							>
								üì§
							</div>
							<div class="stat-info">
								<p class="stat-label">Diterbitkan</p>
								<p class="stat-value"><%= stats.issued || 0 %></p>
							</div>
						</div>

						<div class="stat-card">
							<div
								class="stat-icon"
								style="background: #fcebee; color: #c2185b"
							>
								‚ö†Ô∏è
							</div>
							<div class="stat-info">
								<p class="stat-label">Overdue</p>
								<p class="stat-value"><%= stats.overdue || 0 %></p>
							</div>
						</div>
					</div>

					<!-- Total Value -->
					<div class="value-card">
						<h3>Total Nilai Invoice</h3>
						<p class="value-amount">
							Rp <%= (stats.total_value || 0).toLocaleString('id-ID') %>
						</p>
					</div>

					<!-- Recent Invoices Table -->
					<div class="recent-section">
						<h3>Invoice Terbaru</h3>
						<% if (recentInvoices && recentInvoices.length > 0) { %>
						<div class="table-container">
							<table class="invoices-table">
								<thead>
									<tr>
										<th>No. Invoice</th>
										<th>Penerima</th>
										<th>Perusahaan</th>
										<th>Tanggal</th>
										<th>Total</th>
										<th>Status</th>
										<th>Aksi</th>
									</tr>
								</thead>
								<tbody>
									<% recentInvoices.forEach(invoice => { %>
									<tr>
										<td><strong><%= invoice.invoice_number %></strong></td>
										<td><%= invoice.recipient_name %></td>
										<td><%= invoice.company_name %></td>
										<td>
											<%= new
											Date(invoice.invoice_date).toLocaleDateString('id-ID') %>
										</td>
										<td>
											Rp <%= (invoice.total_amount || 0).toLocaleString('id-ID')
											%>
										</td>
										<td>
											<span class="badge status-<%= invoice.status %>">
												<%= invoice.status.toUpperCase() %>
											</span>
										</td>
										<td>
											<a
												href="/admin/invoice/<%= invoice.id %>"
												class="btn-small"
											>
												Lihat
											</a>
										</td>
									</tr>
									<% }); %>
								</tbody>
							</table>
						</div>
						<% } else { %>
						<div class="empty-state">
							<p>Belum ada invoice</p>
						</div>
						<% } %>
					</div>
				</div>
			</main>
		</div>

		<script>
			// Hamburger Menu Toggle
			const hamburger = document.getElementById("hamburgerMenu")
			const sidebar = document.getElementById("sidebar")
			const overlay = document.getElementById("sidebarOverlay")

			function toggleSidebar() {
				sidebar.classList.toggle("active")
				overlay.classList.toggle("active")
			}

			function closeSidebar() {
				sidebar.classList.remove("active")
				overlay.classList.remove("active")
			}

			hamburger.addEventListener("click", toggleSidebar)
			overlay.addEventListener("click", closeSidebar)

			// Close sidebar when clicking nav items
			document.querySelectorAll(".nav-item").forEach((item) => {
				item.addEventListener("click", closeSidebar)
			})

			// Mark active menu
			document.addEventListener("DOMContentLoaded", () => {
				const currentPath = window.location.pathname
				document.querySelectorAll(".nav-item").forEach((item) => {
					item.classList.remove("active")
					if (item.href.includes(currentPath.split("/").pop())) {
						item.classList.add("active")
					}
				})
			})
		</script>
	</body>
</html>
